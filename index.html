<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario AOI</title>
</head>
<body>

<h2>Formulario AOI</h2>

<form id="formulario">
  <input name="week" placeholder="Week" required><br><br>
  <input name="line" placeholder="Line" required><br><br>
  <input name="model" placeholder="Model" required><br><br>
  <input name="station" placeholder="Station" required><br><br>
  <input name="category" placeholder="Category" required><br><br>
  <input name="problem_type" placeholder="Problem Type" required><br><br>
  <input name="description" placeholder="Description" required><br><br>
  <input name="owner" placeholder="Owner" required><br><br>

  <textarea name="correction_action" placeholder="Correction Action"></textarea><br><br>

  <input type="date" name="date_finished" required><br><br>

  <textarea name="comentarios" placeholder="Comentarios"></textarea><br><br>

  <button type="submit">Enviar</button>
</form>

<script>
console.log("JS CARGADO");

document.getElementById("formulario").addEventListener("submit", function(e) {
  e.preventDefault();
  alert("Submit interceptado");

  const url = "https://script.google.com/macros/s/AKfycbwTfV966Pd2fnzur3R0dTLD_z5QWpBfV3oqvlYgfoVlZ1BG3Bs9wTz409CYd6hBT3Fn9A/exec";
  const formData = new FormData(this);

  fetch(url, {
    method: "POST",
    body: formData
  })
  .then(res => res.text())
  .then(text => {
    alert("Respuesta del servidor: " + text);
    console.log(text);
    this.reset();
  })
  .catch(err => {
    alert("Error en fetch");
    console.error(err);
  });
});
</script>

</body>
</html>
